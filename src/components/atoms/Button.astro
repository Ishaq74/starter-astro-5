---
import { Icon } from 'astro-icon/components';

interface Props {
  type?: 'button' | 'submit' | 'reset';
  ariaLabel?: string;
  text?: string;
  icon?: {
    name: string;
    side?: 'left' | 'right';
  };
  variant?: 'primary' | 'secondary' | 'accent';
  [key: string]: any;
}

const {
  type = 'button',
  ariaLabel,
  text,
  icon,
  variant,
  ...htmlAttributes
} = Astro.props as Props;

const classes = variant ? `button ${variant}` : 'button';
---
<button
  type={type}
  class={classes}
  aria-label={ariaLabel}
  {...htmlAttributes}
>
  {icon?.side === 'left' && <Icon name={icon.name} />}
  {text ? text : <slot />}
  {icon?.side === 'right' && <Icon name={icon.name} />}
</button>

<style is:global>

button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-3) var(--space-5);
  border: 2px solid var(--color-border);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-md);
  background: var(--color-surface, #fff);
  color: var(--color-text);
  font-family: inherit;
  font-size: 1rem;
  font-weight: 600;
  line-height: 1.2;
  cursor: pointer;
  transition: background 0.2s, color 0.2s, border-color 0.2s, box-shadow 0.2s;
  outline: none;
  min-width: 2.5em;
  min-height: 2.5em;
  user-select: none;
}

button:focus {
  border-color: var(--color-focus);
  box-shadow: 0 0 0 3px var(--color-focus);
}
button:active {
  background: var(--color-hover);
  box-shadow: var(--shadow-sm);
}
button:hover {
  background: var(--color-hover);
  color: var(--color-primary);
  border-color: var(--color-primary);
}
button:disabled,
button[aria-disabled="true"] {
  background: var(--color-disabled);
  color: #fff;
  border-color: var(--color-border);
  cursor: not-allowed;
  opacity: 0.7;
  box-shadow: none;
}
button:focus-visible {
  outline: 2px solid var(--color-focus);
  outline-offset: 2px;
}

button[class~="primary"] {
  background: var(--color-primary);
  color: #fff;
  border-color: var(--color-primary);
  box-shadow: var(--shadow-md);
}
button[class~="primary"]:hover,
button[class~="primary"]:active {
  background: var(--color-primary-dark, #22253b);
  color: #fff;
  border-color: var(--color-primary-dark, #22253b);
  box-shadow: var(--shadow-lg);
}
button[class~="secondary"] {
  background: var(--color-secondary);
  color: var(--color-text);
  border-color: var(--color-secondary);
  box-shadow: var(--shadow-md);
}
button[class~="secondary"]:hover,
button[class~="secondary"]:active {
  background: var(--color-secondary-dark, #c0c2c9);
  color: var(--color-primary);
  border-color: var(--color-primary);
  box-shadow: var(--shadow-lg);
}
button[class~="secondary"]:focus {
  border-color: var(--color-focus);
  box-shadow: 0 0 0 3px var(--color-focus);
}
button[class~="secondary"]:disabled,
button[class~="secondary"][aria-disabled="true"] {
  background: var(--color-disabled);
  color: #fff;
  border-color: var(--color-border);
  cursor: not-allowed;
  opacity: 0.7;
  box-shadow: none;
}

button[class~="accent"] {
  background: var(--color-accent);
  color: #fff;
  border-color: var(--color-accent);
  box-shadow: var(--shadow-md);
}
button[class~="accent"]:hover,
button[class~="accent"]:active {
  background: var(--color-accent-dark, #3e4b6a);
  color: #fff;
  border-color: var(--color-accent-dark, #3e4b6a);
  box-shadow: var(--shadow-lg);
}
button[class~="accent"]:focus {
  border-color: var(--color-focus);
  box-shadow: 0 0 0 3px var(--color-focus);
}
button[class~="accent"]:disabled,
button[class~="accent"][aria-disabled="true"] {
  background: var(--color-disabled);
  color: #fff;
  border-color: var(--color-border);
  cursor: not-allowed;
  opacity: 0.7;
  box-shadow: none;
}
/* Showcase: simule l'Ã©tat hover */
button.showcase-hover {
  background: var(--color-hover);
  color: var(--color-primary);
  border-color: var(--color-primary);
  box-shadow: var(--shadow-lg);
}
button[class~="primary"].showcase-hover {
  background: var(--color-primary-dark, #22253b);
  color: #fff;
  border-color: var(--color-primary-dark, #22253b);
  box-shadow: var(--shadow-lg);
}
button[class~="secondary"].showcase-hover {
  background: var(--color-secondary-dark, #c0c2c9);
  color: var(--color-primary);
  border-color: var(--color-primary);
  box-shadow: var(--shadow-lg);
}
button[class~="accent"].showcase-hover {
  background: var(--color-accent-dark, #3e4b6a);
  color: #fff;
  border-color: var(--color-accent-dark, #3e4b6a);
  box-shadow: var(--shadow-lg);
}
</style>